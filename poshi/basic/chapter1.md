# 设计及架构

介绍POSHI的设计思想与整体结构。

### POSHI是什么
POSHI是一门基于Selenium进行二次开发的自动化测试框架（或者语言，我觉得框架更合适）。

### 什么是二次开发
二次开发也就是我们常说的封装，或者做框架。但是一个框架要包含丰富的类和方法。要有一套完整的体系来帮助我们进行封装。可以说框架的设计思想就是整个框架的灵魂，如果设计思想很正确也就意味着这个框架成功了一半，剩下的就是我们怎么样用程序实现这个思想，在开发的过程中我们也许会用到一些设计模式和引用一些开源框架。

### 为什么我们需要二次开发Selenium
#### Selenium的使用困境
在了解了Selenium的相关知识后，也许很多人都会有同样的问题，Selenium提供了很强大的API，为什么我们还需要二次开发它？是因为Selenium不够强大吗？并不是这样的，之所以进行二次开发，并不是因为Selenium不够强大，而是为了让更多的人更好地使用它。

熟悉Selenium的人都知道，不论以何种方式使用它，基本采用 target + behaviour 的命令方式来操纵页面元素，一个完整的testcase，往往会包含若干命令，并且这些命令是以流（过程化）的形式存在的，少则几百条，多则几千条。而这仅仅是一条testcase而已，验收一个产品一条testcase肯定是不够的，因此在这其中，各种testcase之间肯定会存在冗余操作，比如登录初始页面，这样假如某日登录页面的url变化了，必须修改所有涉及到的testcase，这显然是一场噩梦。

接着上面的说，聪明人为了解决上文的问题，会把各种基本操作封装成函数，封装成工具类，之后在testcase的实体类中调用，这已经是一种进步了，因为面对需求的变更，只需要相应的修改函数，修改工具类即可。但随之新的问题又来了，这样的工作必须使得维护人员对于编程比较熟悉，假如公司招了几名新员工，他们对于编程语言一窍不通，因此维护testcase这样的工作对于他们来说门槛就会很高。

#### 如何解决这个困境
那么如何使Selenium变得好用，同时又使它的使用门槛变低，使得更多的人去使用它呢？因此我们需要改变一种方式去看待这个问题。

仔细想想，Selenium作为工具，其实我们是没有必要将心思花在使用工具之外的事情上的，比如编程语言的语法。我们唯一关心的是测试用例和数据。因此假如我们的测试用例（testcase）和数据（metedata），与使用Selenium独立开来，独立的维护它。需要使用Selenium的时候，只需将最终的测试用例和数据交给Selenium，它会自动根据测试用例的描述，把工作完成。

这样做的话，就同时解决了以上的两个困境。因为业务已经和如何使用Selenium分开，因此不必再与编程语言挂钩，因此门槛变低，同时维护业务数据有很多种成熟的手段，维护性难度也降低不少。

#### Page Object模式
页面对象是在交互性测试中，你做涉及到的Web应用的UI界面。

使用PO模式的好处：

* 可以在不同的测试用例中，使用可复用的的代码。
* 减少代码冗余。
* 如果UI发生变动，只需要维护少量的代码。  

详见[Page Object Pattern](http://selenium-python.readthedocs.org/page-objects.html)。

#### POSHI是如何做的
POSHI正式按这种思想和模式实现的，它将Selenium的API封装成工具库，存放于Liferay Portal项目的源码中。在这个基础上，采用xml结构的文件对测试用例和数据进行描述，这样只需要再额外提供一个runtime使两者结合到一起运行即可。
* POSHI 1.0和POSHI 2.0分别采用两种不同的方式使其结合：
  - POSHI 1.0中采用静态渲染的方式，提供一个编译器，将xml测试用例渲染成可执行的JAVA文件，之后在JVM中运行。
  - POSHI 2.0中采用虚拟机的方式，提供一个runner虚拟机环境，加载xml测试用例之后执行相应操作。

细节会在后续章节介绍。

### 我所需要了解的
作为POSHI的使用者来说，对于设计与架构，对于框架设计等一系列知识不需要了解，但对于设计思想这些需要简单了解，这对于使用工具还是开发工具，都有很大的益处。



